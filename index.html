<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>  
</head>
<body>
    <h1>V2</h1>
    <input type="file" id="my_file_input" >
<textarea id="abc">

</textarea>
    <script>
        var obj_csv = {
    size:0,
    dataFile:[]
};
var oFileIn;

$(function() {
    oFileIn = document.getElementById('my_file_input');
    if(oFileIn.addEventListener) {
        oFileIn.addEventListener('change', filePicked, false);
    }
});


function filePicked(oEvent) {
    // Get The File From The Input
    var oFile = oEvent.target.files[0];
    var sFilename = oFile.name;
    // Create A File Reader HTML5
    var reader = new FileReader();
    
    // Ready The Event For When A File Gets Selected
    reader.onload = function(e) {
        var data = e.target.result;
        var workbook  = XLSX.read(data, {type: 'binary'});
        var first_sheet_name = workbook.SheetNames[0];
        var first_worksheet = workbook.Sheets[first_sheet_name];
        var jsondata = XLSX.utils.sheet_to_json(first_worksheet, {header:1});
    
        parseData(jsondata);
        // Loop Over Each Sheet
      
    };
    
    // Tell JS To Start Reading The File.. You could delay this if desired
    reader.readAsBinaryString(oFile);
}

 
 
function parseData(data){


    var temp = [];
    var d='';
    var i = 0;
    var f=true;
    data.forEach(element => {
        if(f){
            f=!f;
            return;
        }
        temp[i]=[];
        d+="[";

        element.forEach(e => {
            d+="'"+e+"',";
            temp[i].push(e);
        });


        d=d.slice(0, -1);
        d+="],";
        i++;
    });
    d=d.slice(0, -1);

  


    var x = 'script';
    var b=`
    <div dir='rtl'>
    <h3>بحث</h3>

    <input type="text" id="myText" value="">



    <button onclick="myFunction()">بحث</button>

    <p id="demo"></p>

    <script>
        var x;
        function checkid(row) {
            return row[0] == x;
        }
        function myFunction() {
            x = document.getElementById("myText").value;
            var data = [`+d+`];

            var a = data.find(checkid);
            if (a != undefined) {

                document.getElementById("demo").innerHTML = a[1];
            }


        }
    `+`</`+ x +`>
    </div>
    `;
  
    document.getElementById("abc").innerHTML = b;
}
    </script>
</body>
</html>